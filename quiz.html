2<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Let's Play the Game</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow-x: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #f0f2f5;
        }

        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-shape {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite linear;
        }

        .shape-1 { top: 20%; left: 10%; width: 60px; height: 60px; background: #ff6b6b; border-radius: 50%; animation-delay: 0s; }
        .shape-2 { top: 60%; left: 80%; width: 40px; height: 40px; background: #4ecdc4; border-radius: 20%; animation-delay: 5s; }
        .shape-3 { top: 30%; left: 70%; width: 50px; height: 50px; background: #45b7d1; transform: rotate(45deg); animation-delay: 10s; }
        .shape-4 { top: 80%; left: 20%; width: 70px; height: 70px; background: #f7b731; border-radius: 30%; animation-delay: 15s; }

        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-30px) rotate(120deg); }
            66% { transform: translateY(20px) rotate(240deg); }
            100% { transform: translateY(0px) rotate(360deg); }
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            padding: 40px;
            width: 95%;
            max-width: 1000px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 10;
        }

        .container:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        h1 {
            color: #ff6b6b;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            font-weight: 700;
        }

        .question-container {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 30px;
            margin: 20px 0;
            border-radius: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .question-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .question-container:hover::before {
            left: 100%;
        }

        .question-container:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            width: 100%;
        }

        .question-number {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .category-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            color: white;
        }

        .eq { background: linear-gradient(45deg, #ff6b6b, #ee5a24); }
        .iq { background: linear-gradient(45deg, #4ecdc4, #44a08d); }
        .fq { background: linear-gradient(45deg, #45b7d1, #2980b9); }
        .sq { background: linear-gradient(45deg, #f7b731, #f39c12); }

        .scenario-title {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: bold;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.6));
            padding: 8px 16px;
            border-radius: 10px;
            text-shadow: none;
        }

        .scenario-text {
            font-size: 1em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: left;
            line-height: 1.5;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .question-text {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(255, 255, 255, 0.8);
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            position: relative;
            max-width: 80%;
            display: inline-block;
        }

        .question-text::before {
            content: attr(data-number);
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.6);
            color: white;
            font-size: 0.8em;
            padding: 2px 8px;
            border-radius: 50%;
        }

        .options-grid {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            width: 100%;
        }

        .option {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(8px);
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid rgba(255, 255, 255, 0.4);
            font-weight: 600;
            color: #2c3e50;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .option:nth-child(1) { background: linear-gradient(135deg, #f6d365, #fda085); }
        .option:nth-child(2) { background: linear-gradient(135deg, #a18cd1, #fbc2eb); }
        .option:nth-child(3) { background: linear-gradient(135deg, #84fab0, #8fd3f4); }
        .option:nth-child(4) { background: linear-gradient(135deg, #a1c4fd, #c2e9fb); }
        .option:nth-child(5) { background: #ff6b6b; }

        .option:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.5);
        }

        .option.selected {
            background: #00ff00;
            color: #2c3e50;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 255, 0, 0.4);
        }

        .option input {
            display: none;
        }

        .likert-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9em;
            color: #2c3e50;
            font-weight: 600;
        }

        .mcq-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        #timer-container {
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        #timer-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        #timer-progress {
            height: 100%;
            background: linear-gradient(90deg, #00f260, #0575e6, #f093fb, #f5576c);
            background-size: 400% 100%;
            border-radius: 10px;
            transition: width 1s linear;
            box-shadow: 0 0 15px rgba(0, 242, 96, 0.5);
        }

        #timer-bar.low-time #timer-progress {
            animation: timerGradient 1s ease infinite;
        }

        @keyframes timerGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .timer-warning {
            background: linear-gradient(90deg, #ff416c, #ff4b2b) !important;
            animation: pulse 0.5s ease infinite alternate !important;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0.7; transform: scale(1.02); }
        }

        .page-blink {
            animation: pageBlink 0.3s ease 3;
        }

        @keyframes pageBlink {
            0%, 100% { background-color: rgba(255, 0, 0, 0); }
            50% { background-color: rgba(255, 0, 0, 0.2); }
        }

        #timer-text {
            color: #2c3e50;
            font-size: 1.1em;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            margin: 10px;
        }

        button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(-1px) scale(1.02);
        }

        #results {
            margin-top: 30px;
            display: none;
        }

        .results-table {
            margin: 25px 0;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            width: 100%;
        }

        .results-table table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .results-table th, .results-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        .results-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }

        .results-table td {
            color: #2c3e50;
            font-weight: 600;
        }

        .results-text {
            font-size: 1.1em;
            color: #2c3e50;
            margin: 20px 0;
            line-height: 1.5;
            text-align: left;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .recommendation {
            font-size: 1.1em;
            color: #2c3e50;
            margin: 20px 0;
            line-height: 1.5;
            text-align: left;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #ff6b6b;
        }

        .footer {
            margin-top: 30px;
            font-size: 0.9em;
            color: #2c3e50;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        }

        #warning {
            display: none;
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
            color: white;
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
            font-weight: bold;
            box-shadow: 0 8px 25px rgba(255, 65, 108, 0.3);
            animation: warningPulse 1s ease infinite alternate;
        }

        @keyframes warningPulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.02); }
        }

        .completion-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.2), rgba(78, 205, 196, 0.2), rgba(69, 183, 209, 0.2), rgba(247, 183, 49, 0.2));
            z-index: 1000;
            display: none;
            animation: celebration 3s ease-in-out;
        }

        @keyframes celebration {
            0%, 100% { opacity: 0; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .completion-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .completion-message h2 {
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confetti-fall 3s linear infinite;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .logo {
            position: absolute;
            top: 20px;
            left: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
            max-width: 150px;
            border-radius: 50%;
            border: 3px solid #8a2be2;
            box-shadow: 0 0 20px #8a2be2, 0 0 40px #8a2be2, 0 0 60px #8a2be2;
            animation: glow 2s ease-in-out infinite alternate;
            z-index: 100;
        }
        .logo:hover {
            transform: scale(1.1);
        }
        @keyframes glow {
            from {
                box-shadow: 0 0 20px #8a2be2, 0 0 40px #8a2be2, 0 0 60px #8a2be2;
            }
            to {
                box-shadow: 0 0 30px #8a2be2, 0 0 50px #8a2be2, 0 0 80px #8a2be2;
            }
        }

        @media (max-width: 768px) {
            .container { padding: 20px; }
            .question-text { font-size: 1.1em; }
            .options-grid { flex-wrap: wrap; }
            .mcq-options { flex-wrap: wrap; }
        }
    </style>
</head>
<body>
    <img src="https://i.imghippo.com/files/skIN5770PQ.webp" alt="Logo" class="logo" onclick="window.open('https://espiratia.com/', '_blank')">
    <div class="floating-shapes">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
        <div class="floating-shape shape-4"></div>
    </div>

    <div class="completion-celebration" id="celebrationOverlay">
        <div class="completion-message">
            <h2>üéâ Congratulations! üéâ</h2>
            <p>You have completed the assessment!</p>
        </div>
    </div>

    <div class="container">
        <h1>Multidimensional Quotient scale (MQS)</h1>
        <div id="quiz"></div>
        <div id="timer-container">
            <div id="timer-bar"><div id="timer-progress"></div></div>
            <p id="timer-text"></p>
        </div>
        <div id="warning"></div>
        <button onclick="nextQuestion()" id="nextButton">Next</button>
        <button onclick="resetQuiz()" id="resetButton" style="display: none;">üîÑ Reset Quiz</button>
    <div id="results">
    <div class="results-table">
        <h2>üìä Your Performance</h2>
        <table>
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Percentage</th>
                    <th>Rating</th>
                </tr>
            </thead>
            <tbody id="resultsTableBody"></tbody>
        </table>
    </div>
    <div id="charts-container" style="display: flex; justify-content: space-around; margin: 20px 0; flex-wrap: wrap;"></div>
    <div class="results-text" id="resultsText"></div>
    <div class="recommendation" id="recommendation"></div>
    <button onclick="showCharts()">Visualize Results</button>
        </div>
        <div class="footer">
            &copy; 2025 Espiratia. All Rights Reserved.
        </div>
    </div>

    <script>
        let tabSwitchCount = 0;
        let isDisqualified = false;
let answers = {};
let quizResults;
let userName, userEmail;

fetch('check_session.php')
.then(response => response.json())
.then(data => {
    if (!data.logged_in) {
        window.location.href = 'login.html';
        return;
    } else if (data.taken) {
        alert('You have already taken the assessment.');
        window.location.href = 'login.html';
        return;
    } else {
        userName = data.name;
        userEmail = data.email;
        startQuiz();
    }
})
.catch(error => {
    console.error('Error checking session:', error);
    window.location.href = 'login.html';
});

        document.addEventListener('visibilitychange', () => {
            if (document.hidden && !isDisqualified && currentIndex < shuffledQuestions.length) {
                tabSwitchCount++;
                const warningDiv = document.getElementById('warning');
                if (tabSwitchCount === 1 || tabSwitchCount === 2) {
                    warningDiv.style.display = 'block';
                    warningDiv.textContent = `‚ö†Ô∏è Warning: You have switched tabs ${tabSwitchCount} time(s). Another switch will disqualify you!`;
                } else if (tabSwitchCount >= 3) {
                    isDisqualified = true;
                    warningDiv.style.display = 'block';
                    warningDiv.textContent = '‚ùå You have been disqualified for switching tabs 3 times!';
                    document.getElementById('quiz').style.display = 'none';
                    document.getElementById('timer-container').style.display = 'none';
                    document.getElementById('nextButton').style.display = 'none';
                    clearInterval(timerInterval);
                }
            } else if (!document.hidden && tabSwitchCount > 0 && tabSwitchCount < 3) {
                const warningDiv = document.getElementById('warning');
                warningDiv.style.display = 'none';
            }
        });

        const questions = [
            // Original EQ Questions (Likert)
            { id: 'eq1', text: 'I recognize when my emotions are influencing my decisions.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-1.jpg' },
            { id: 'eq2', text: 'I remain calm under pressure or during conflict.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-2.jpg' },
            { id: 'eq3', text: 'I try to understand how others are feeling even if they don\'t say it out loud.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-3.jpg' },
            { id: 'eq4', text: 'I find it easy to express how I feel without offending others.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-4.jpg' },
            { id: 'eq5', text: 'When I\'m frustrated or angry, I know how to manage those emotions effectively.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-5.jpg' },
            { id: 'eq6', text: 'I reflect on my emotional responses after an intense interaction.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-6.jpg' },
            { id: 'eq7', text: 'I can tell when someone is hiding their real feelings.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-7.jpg' },
            { id: 'eq8', text: 'I adjust my behavior based on others\' emotional reactions.', type: 'likert', category: 'EQ', timeLimit: 10, bgPath: 'images/EQ/EQ-8.jpg' },
            // Scenario-Based EQ Questions
            {
                id: 'eq9', title: 'Group Project Conflict',
                scenario: "You're working on a group assignment. One teammate is upset because their ideas are ignored. They send an angry message in the group chat.",
                text: 'Choose your response:',
                type: 'scenario', category: 'EQ', options: [
                    'Ignore the message.',
                    'Reply politely but avoid discussing their concern.',
                    'Acknowledge their feelings and suggest a group discussion.',
                    'Blame them for being too sensitive.'
                ], scores: [0.3, 0.6, 1, 0], timeLimit: 25, bgPath: 'images/SC/SC-1.jpg'
            },
            {
                id: 'eq10', title: 'Exam Stress',
                scenario: 'A close friend is panicking before exams, saying "I\'m going to fail no matter what."',
                text: 'How would you respond?',
                type: 'scenario', category: 'EQ', options: [
                    '"You\'re overreacting, just study harder."',
                    'Listen patiently and remind them of their preparation.',
                    'Share your own stress and make them feel you\'re both struggling.',
                    'Suggest skipping the exam.'
                ], scores: [0.3, 1, 0.6, 0], timeLimit: 25, bgPath: 'images/SC/SC-2.jpg'
            },

            // Original IQ Questions (MCQ)
            { id: 'iq1', text: 'Which number logically completes the series? 2, 4, 8, 16, ?', type: 'mcq', category: 'IQ', options: ['18', '24', '32', '26'], correct: '32', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-1.jpg' },
            { id: 'iq2', text: 'If all bloops are razzies, and all razzies are lazzies, are all bloops definitely lazzies?', type: 'mcq', category: 'IQ', options: ['Yes', 'No', 'Cannot be determined', 'Only some are'], correct: 'Yes', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-2.jpg' },
            { id: 'iq3', text: 'Mary is older than Tom. Tom is older than Sara. Who is the youngest?', type: 'mcq', category: 'IQ', options: ['Mary', 'Tom', 'Sara', 'Cannot be determined'], correct: 'Sara', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-3.jpg' },
            { id: 'iq4', text: 'What comes next in the pattern? A, C, F, J, O, ?', type: 'mcq', category: 'IQ', options: ['S', 'T', 'U', 'Q'], correct: 'T', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-4.jpg' },
            { id: 'iq5', text: 'Rearrange the letters "RAPET" to make a valid word. What is it?', type: 'mcq', category: 'IQ', options: ['TAPER', 'PRATE', 'REAPT', 'PETAR'], correct: 'TAPER', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-5.jpg' },
            { id: 'iq6', text: 'If the day after tomorrow is Wednesday, what day is today?', type: 'mcq', category: 'IQ', options: ['Sunday', 'Monday', 'Tuesday', 'Saturday'], correct: 'Monday', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-6.jpg' },
            { id: 'iq7', text: 'Which shape is the odd one out? Circle, Square, Triangle, Cube', type: 'mcq', category: 'IQ', options: ['Circle', 'Square', 'Triangle', 'Cube'], correct: 'Cube', timeLimit: Math.floor(Math.random() * 16) + 15, bgPath: 'images/IQ/IQ-7.jpg' },
            // Scenario-Based IQ Questions
            {
                id: 'iq8', title: 'Lost Notes Puzzle',
                scenario: 'A classmate lost their notes for revision. They remember: Topic A was before Topic B. Topic C was after Topic A. Topic B was before Topic C.',
                text: 'Arrange A, B, C in correct order:',
                type: 'scenario', category: 'IQ', options: [
                    'A ‚Üí B ‚Üí C',
                    'A ‚Üí C ‚Üí B',
                    'B ‚Üí A ‚Üí C',
                    'C ‚Üí B ‚Üí A'
                ], scores: [1, 0.6, 0, 0], timeLimit: 30, bgPath: 'images/SC/SC-5.jpg'
            },
            {
                id: 'iq9', title: 'Study Plan Time Management',
                scenario: 'You have 3 hours to revise 3 subjects: Math (needs 90 min), Psychology (needs 60 min), Literature (needs 30 min).',
                text: 'Create the best schedule:',
                type: 'scenario', category: 'IQ', options: [
                    'Math 90 + Psychology 60 + Literature 30 (perfect fit)',
                    'Psychology 90 + Literature 60 + Math 30',
                    'Spend time only on favorite subject',
                    'Skip one subject completely'
                ], scores: [1, 0.6, 0.2, 0.2], timeLimit: 30, bgPath: 'images/SC/SC-6.jpg'
            },

            // Original FQ Questions (Likert)
            { id: 'fq1', text: 'I track my income and expenses regularly.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-1.jpg' },
            { id: 'fq2', text: 'I avoid unnecessary purchases even when tempted.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-2.jpg' },
            { id: 'fq3', text: 'I set short-term and long-term financial goals.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-3.jpg' },
            { id: 'fq4', text: 'I have an emergency fund or savings set aside.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-4.jpg' },
            { id: 'fq5', text: 'Before investing, I evaluate the risk involved.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-5.jpg' },
            { id: 'fq6', text: 'I know the difference between assets and liabilities.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-6.jpg' },
            { id: 'fq7', text: 'I understand basic financial terms like "inflation," "interest," or "diversification."', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-7.jpg' },
            { id: 'fq8', text: 'I am confident making independent financial decisions.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-8.jpg' },
            { id: 'fq9', text: 'I review my bank or credit card statements each month.', type: 'likert', category: 'FQ', timeLimit: 15, bgPath: 'images/FQ/FQ-9.jpg' },
            // Scenario-Based FQ Questions
            {
                id: 'fq10', title: 'Budgeting Pocket Money',
                scenario: 'You get ‚Çπ2000/month pocket money. Hostel expenses: ‚Çπ1200, Food: ‚Çπ500, Movies/Fun: ‚Çπ500.',
                text: 'How will you budget to save at least ‚Çπ300?',
                type: 'scenario', category: 'FQ', options: [
                    'Cut fun to ‚Çπ200, save ‚Çπ300.',
                    'Spend all, save nothing.',
                    'Borrow from friends to cover shortfall.',
                    'Save by skipping meals.'
                ], scores: [1, 0, 0.4, 0.2], timeLimit: 30, bgPath: 'images/SC/SC-7.jpg'
            },
            {
                id: 'fq11', title: 'Laptop Purchase Decision',
                scenario: 'You need a laptop. Option 1: ‚Çπ40,000, 2-year warranty. Option 2: ‚Çπ50,000, 4-year warranty + free upgrades.',
                text: 'Which is better long-term value?',
                type: 'scenario', category: 'FQ', options: [
                    'Option 1 (‚Çπ40,000, 2-year warranty)',
                    'Option 2 (‚Çπ50,000, 4-year warranty + upgrades)',
                    'Buy the cheapest available anywhere',
                    'Don\'t buy, borrow from friends'
                ], scores: [0.5, 1, 0, 0], timeLimit: 30, bgPath: 'images/SC/SC-8.jpg'
            },

            // Original SQ Questions (Likert)
            { id: 'sq1', text: 'I find it easy to initiate conversations in unfamiliar groups.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-1.jpg' },
            { id: 'sq2', text: 'I adapt my communication style depending on who I am talking to.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-2.jpg' },
            { id: 'sq3', text: 'I enjoy helping others without expecting anything in return.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-3.jpg' },
            { id: 'sq4', text: 'I listen to people carefully without interrupting them.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-4.jpg' },
            { id: 'sq5', text: 'I prefer cooperation over competition in group settings.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-5.jpg' },
            { id: 'sq6', text: 'I easily sense tension or discomfort in social situations.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-6.jpg' },
            { id: 'sq7', text: 'People often approach me for advice or emotional support.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-7.jpg' },
            { id: 'sq8', text: 'I maintain good relationships with people from different backgrounds.', type: 'likert', category: 'SQ', timeLimit: 10, bgPath: 'images/SQ/SQ-8.jpg' },
            // Scenario-Based SQ Questions
            {
                id: 'sq9', title: 'Class Participation',
                scenario: 'During a seminar, one classmate dominates the conversation. Another shy student looks like they want to speak.',
                text: 'Choose your action:',
                type: 'scenario', category: 'SQ', options: [
                    'Encourage the shy student to share.',
                    'Stay quiet, let the loud student continue.',
                    'Interrupt loudly to grab attention yourself.',
                    'Change the topic altogether.'
                ], scores: [1, 0.4, 0.2, 0], timeLimit: 25, bgPath: 'images/SC/SC-3.jpg'
            },
            {
                id: 'sq10', title: 'Cultural Festival Teaming',
                scenario: 'You\'re organizing a college cultural event. Two members are from very different backgrounds and disagree strongly.',
                text: 'Pick your approach:',
                type: 'scenario', category: 'SQ', options: [
                    'Let them sort it out alone.',
                    'Act as mediator, listen to both sides, and find middle ground.',
                    'Support only the friendlier member.',
                    'Cancel their responsibilities and do it yourself.'
                ], scores: [0.3, 1, 0.2, 0], timeLimit: 25, bgPath: 'images/SC/SC-4.jpg'
            }
        ];

        let shuffledQuestions = [];
        let currentIndex = 0;
        let timerInterval;
        let remainingTime;

        function startQuiz() {
            shuffledQuestions = shuffle([...questions]);
            currentIndex = 0;
            answers = {};
            renderCurrentQuestion();
            document.getElementById('nextButton').style.display = 'inline-block';
            document.getElementById('resetButton').style.display = 'none';
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz').style.display = 'block';
            document.getElementById('timer-container').style.display = 'block';
            document.getElementById('warning').style.display = 'none';
            tabSwitchCount = 0;
            isDisqualified = false;
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderCurrentQuestion() {
            const quizContainer = document.getElementById('quiz');
            quizContainer.innerHTML = '';
            
            if (currentIndex >= shuffledQuestions.length || isDisqualified) {
                showResults();
                return;
            }

            const q = shuffledQuestions[currentIndex];
            document.body.style.backgroundImage = `url('${q.bgPath}')`;
            document.body.style.backgroundSize = 'cover';
            document.body.style.backgroundPosition = 'center';
            document.body.style.backgroundRepeat = 'no-repeat';

            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-container';
            
            const questionHeader = document.createElement('div');
            questionHeader.className = 'question-header';
            questionHeader.innerHTML = `
                <div class="question-number">${currentIndex + 1}/${shuffledQuestions.length}</div>
                <div class="category-badge ${q.category.toLowerCase()}">${q.category}</div>
            `;

            if (q.type === 'scenario') {
                const scenarioTitle = document.createElement('div');
                scenarioTitle.className = 'scenario-title';
                scenarioTitle.textContent = q.title;

                const scenarioText = document.createElement('div');
                scenarioText.className = 'scenario-text';
                scenarioText.textContent = q.scenario;

                questionDiv.appendChild(scenarioTitle);
                questionDiv.appendChild(scenarioText);
            }

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.setAttribute('data-number', `${currentIndex + 1}`);
            questionText.textContent = q.text;

            questionDiv.appendChild(questionHeader);
            questionDiv.appendChild(questionText);

            if (q.type === 'likert') {
                const likertLabels = document.createElement('div');
                likertLabels.className = 'likert-labels';
                likertLabels.innerHTML = `
                    <span>Strongly Disagree</span>
                    <span>Neutral</span>
                    <span>Strongly Agree</span>
                `;
                
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options-grid';
                
                for (let i = 1; i <= 5; i++) {
                    const optionLabel = document.createElement('label');
                    optionLabel.className = 'option';
                    optionLabel.innerHTML = `
                        <input type="radio" name="${q.id}" value="${i}" onchange="markAnswered(this)">
                        ${i}
                    `;
                    optionsDiv.appendChild(optionLabel);
                }
                
                questionDiv.appendChild(likertLabels);
                questionDiv.appendChild(optionsDiv);
            } else if (q.type === 'mcq' || q.type === 'scenario') {
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'mcq-options';
                
                q.options.forEach((opt, index) => {
                    const optionLabel = document.createElement('label');
                    optionLabel.className = 'option';
                    optionLabel.innerHTML = `
                        <input type="radio" name="${q.id}" value="${q.type === 'mcq' ? opt : index}" onchange="markAnswered(this)">
                        ${opt}
                    `;
                    optionsDiv.appendChild(optionLabel);
                });
                
                questionDiv.appendChild(optionsDiv);
            }

            quizContainer.appendChild(questionDiv);
            startTimer(q.timeLimit);
        }

        function startTimer(timeLimit) {
            clearInterval(timerInterval);
            remainingTime = timeLimit;
            const timerProgress = document.getElementById('timer-progress');
            const timerText = document.getElementById('timer-text');
            const timerBar = document.getElementById('timer-bar');
            
            timerText.textContent = `‚è∞ Time left: ${remainingTime}s`;
            timerProgress.style.transitionDuration = `${timeLimit}s`;
            timerProgress.style.width = '100%';
            timerBar.classList.remove('low-time');
            
            setTimeout(() => {
                timerProgress.style.width = '0%';
            }, 10);
            
            timerInterval = setInterval(() => {
                remainingTime--;
                timerText.textContent = `‚è∞ Time left: ${remainingTime}s`;
                
                if (remainingTime <= 3) {
                    timerBar.classList.add('low-time');
                    document.body.classList.add('page-blink');
                    setTimeout(() => {
                        document.body.classList.remove('page-blink');
                    }, 300);
                }
                
                if (remainingTime <= 0 && !isDisqualified) {
                    clearInterval(timerInterval);
                    nextQuestion();
                }
            }, 1000);
        }

        function markAnswered(input) {
            const options = document.querySelectorAll(`input[name="${input.name}"]`);
            const optionLabels = document.querySelectorAll(`label.option`);

            optionLabels.forEach(label => label.classList.remove('selected'));
            input.parentElement.classList.add('selected');

            answers[input.name] = input.value;

            if (!isDisqualified) {
                document.getElementById('nextButton').style.display = 'inline-block';
            }
        }

        function nextQuestion() {
            if (!isDisqualified) {
                clearInterval(timerInterval);
                currentIndex++;
                renderCurrentQuestion();
                document.getElementById('nextButton').style.display = currentIndex < shuffledQuestions.length ? 'inline-block' : 'none';
            }
        }

        function calculateResults() {
            let eqScore = 0, iqScore = 0, fqScore = 0, sqScore = 0;
            let eqCount = 0, iqCount = 0, fqCount = 0, sqCount = 0;

            questions.forEach(q => {
                let score = 0;
                const ans = answers[q.id];
                if (ans !== undefined) {
                    if (q.type === 'likert') {
                        score = parseInt(ans) / 5;
                    } else if (q.type === 'mcq') {
                        score = ans === q.correct ? 1 : 0;
                    } else if (q.type === 'scenario') {
                        const selectedIndex = parseInt(ans);
                        score = q.scores[selectedIndex] || 0;
                    }
                }
                if (q.category === 'EQ') {
                    eqScore += score;
                    eqCount++;
                } else if (q.category === 'IQ') {
                    iqScore += score;
                    iqCount++;
                } else if (q.category === 'FQ') {
                    fqScore += score;
                    fqCount++;
                } else if (q.category === 'SQ') {
                    sqScore += score;
                    sqCount++;
                }
            });

            const eqPercent = (eqScore / eqCount) * 100;
            const iqPercent = (iqScore / iqCount) * 100;
            const fqPercent = (fqScore / fqCount) * 100;
            const sqPercent = (sqScore / sqCount) * 100;

            return { eqPercent, iqPercent, fqPercent, sqPercent };
        }

        function getRecommendations(results) {
            const recommendations = [];
            if (results.eqPercent < 60) {
                recommendations.push("**Emotional Quotient (EQ):** Your emotional intelligence could use improvement. Practice active listening, empathy exercises, or journaling to better understand and manage your emotions.");
            } else if (results.eqPercent >= 80) {
                recommendations.push("**Emotional Quotient (EQ):** Excellent emotional intelligence! Continue nurturing your skills by engaging in group discussions or mentoring others.");
            }

            if (results.iqPercent < 60) {
                recommendations.push("**Intelligence Quotient (IQ):** Your problem-solving skills could improve. Try logic puzzles, brain teasers, or time management exercises to sharpen your analytical abilities.");
            } else if (results.iqPercent >= 80) {
                recommendations.push("**Intelligence Quotient (IQ):** Strong analytical skills! Keep challenging yourself with complex problems or learning new skills.");
            }

            if (results.fqPercent < 60) {
                recommendations.push("**Financial Quotient (FQ):** Financial management needs work. Start by creating a budget, tracking expenses, or learning basic financial concepts like saving and investing.");
            } else if (results.fqPercent >= 80) {
                recommendations.push("**Financial Quotient (FQ):** Great financial awareness! Explore advanced topics like investing or long-term financial planning.");
            }

            if (results.sqPercent < 60) {
                recommendations.push("**Social Quotient (SQ):** Your social skills could benefit from practice. Try initiating conversations in groups or joining clubs to build confidence.");
            } else if (results.sqPercent >= 80) {
                recommendations.push("**Social Quotient (SQ):** Outstanding social skills! Continue fostering relationships by mediating conflicts or collaborating in diverse teams.");
            }

            return recommendations.length > 0 ? recommendations.join('<br><br>') : 'Balanced performance across all areas! Keep practicing to maintain your skills.';
        }

        function showResults() {
            const celebrationOverlay = document.getElementById('celebrationOverlay');
            celebrationOverlay.style.display = 'block';
            
            createConfetti();
            
            setTimeout(() => {
                celebrationOverlay.style.display = 'none';
                
                const results = calculateResults();
                quizResults = results;
                document.getElementById('quiz').style.display = 'none';
                document.getElementById('timer-container').style.display = 'none';
                document.getElementById('nextButton').style.display = 'none';
                document.getElementById('resetButton').style.display = 'inline-block';
                document.getElementById('results').style.display = 'block';

                const resultsTableBody = document.getElementById('resultsTableBody');
                resultsTableBody.innerHTML = `
                    <tr>
                        <td>Emotional Quotient (EQ)</td>
                        <td>${results.eqPercent.toFixed(1)}%</td>
                        <td>${results.eqPercent >= 80 ? 'Excellent' : results.eqPercent >= 60 ? 'Good' : 'Needs Improvement'}</td>
                    </tr>
                    <tr>
                        <td>Intelligence Quotient (IQ)</td>
                        <td>${results.iqPercent.toFixed(1)}%</td>
                        <td>${results.iqPercent >= 80 ? 'Excellent' : results.iqPercent >= 60 ? 'Good' : 'Needs Improvement'}</td>
                    </tr>
                    <tr>
                        <td>Financial Quotient (FQ)</td>
                        <td>${results.fqPercent.toFixed(1)}%</td>
                        <td>${results.fqPercent >= 80 ? 'Excellent' : results.fqPercent >= 60 ? 'Good' : 'Needs Improvement'}</td>
                    </tr>
                    <tr>
                        <td>Social Quotient (SQ)</td>
                        <td>${results.sqPercent.toFixed(1)}%</td>
                        <td>${results.sqPercent >= 80 ? 'Excellent' : results.sqPercent >= 60 ? 'Good' : 'Needs Improvement'}</td>
                    </tr>
                `;

                const resultsText = document.getElementById('resultsText');
                resultsText.innerHTML = `<strong>Your Results:</strong><br>${resultsTableBody.innerHTML}`;

                const recommendation = document.getElementById('recommendation');
                recommendation.innerHTML = `<strong>Recommendations:</strong><br>${getRecommendations(results)}`;

                // Create charts
                const chartsContainer = document.getElementById('charts-container');
                chartsContainer.innerHTML = '';

                // Pie Chart
                const pieCanvas = document.createElement('canvas');
                pieCanvas.width = 150;
                pieCanvas.height = 150;
                chartsContainer.appendChild(pieCanvas);
                const pieCtx = pieCanvas.getContext('2d');
                new Chart(pieCtx, {
                    type: 'pie',
                    data: {
                        labels: ['EQ', 'IQ', 'FQ', 'SQ'],
                        datasets: [{
                            data: [results.eqPercent, results.iqPercent, results.fqPercent, results.sqPercent],
                            backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b731'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        hover: {
                            mode: 'nearest',
                            intersect: false
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    font: {
                                        size: 11
                                    }
                                }
                            },
                            title: {
                                display: true,
                                text: 'Quotient Distribution',
                                font: {
                                    size: 13
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.label + ': ' + context.parsed.toFixed(1) + '%';
                                    }
                                }
                            }
                        }
                    }
                });

                // Bar Chart
                const barCanvas = document.createElement('canvas');
                barCanvas.width = 250;
                barCanvas.height = 150;
                chartsContainer.appendChild(barCanvas);
                const barCtx = barCanvas.getContext('2d');
                const ratings = [
                    results.eqPercent >= 80 ? 'Excellent' : results.eqPercent >= 60 ? 'Good' : 'Needs Improvement',
                    results.iqPercent >= 80 ? 'Excellent' : results.iqPercent >= 60 ? 'Good' : 'Needs Improvement',
                    results.fqPercent >= 80 ? 'Excellent' : results.fqPercent >= 60 ? 'Good' : 'Needs Improvement',
                    results.sqPercent >= 80 ? 'Excellent' : results.sqPercent >= 60 ? 'Good' : 'Needs Improvement'
                ];
                new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: ['EQ', 'IQ', 'FQ', 'SQ'],
                        datasets: [{
                            label: 'Percentage',
                            data: [results.eqPercent, results.iqPercent, results.fqPercent, results.sqPercent],
                            backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b731'],
                            borderWidth: 1,
                            borderRadius: 4,
                            hoverBackgroundColor: ['#ff5252', '#26a69a', '#2196f3', '#ffb300']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        hover: {
                            mode: 'index',
                            intersect: false,
                            animationDuration: 200
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Category Scores',
                                font: {
                                    size: 13
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleFont: {
                                    size: 11
                                },
                                bodyFont: {
                                    size: 11
                                },
                                callbacks: {
                                    label: function(context) {
                                        return context.label + ': ' + context.parsed.y.toFixed(1) + '% (' + ratings[context.dataIndex] + ')';
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    font: {
                                        size: 11
                                    }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    font: {
                                        size: 11
                                    },
                                    stepSize: 20
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });

                let pieChartData = pieCanvas.toDataURL();
                let barChartData = barCanvas.toDataURL();

                chartsContainer.innerHTML = '';

                fetch('mark_taken.php')
                .then(() => {
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = 'results.php';

                    const data = {
                        eqPercent: results.eqPercent,
                        iqPercent: results.iqPercent,
                        fqPercent: results.fqPercent,
                        sqPercent: results.sqPercent,
                        recommendations: getRecommendations(results),
                        pieChart: pieChartData,
                        barChart: barChartData,
                        user_name: userName,
                        user_email: userEmail
                    };

                    for (const key in data) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = key;
                        input.value = data[key];
                        form.appendChild(input);
                    }

                    document.body.appendChild(form);
                    form.submit();
                })
                .catch(error => console.error('Error marking taken:', error));
            }, 3000);
        }

        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b731', '#a55eea', '#26de81'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        function resetQuiz() {
            document.getElementById('results').style.display = 'none';
            const inputs = document.querySelectorAll('input[type="radio"]');
            inputs.forEach(input => {
                input.checked = false;
            });
            answers = {};
            tabSwitchCount = 0;
            isDisqualified = false;
            startQuiz();
        }

        function showCharts() {
            const chartsContainer = document.getElementById('charts-container');
            chartsContainer.innerHTML = '';

            // Pie Chart
            const pieCanvas = document.createElement('canvas');
            pieCanvas.width = 150;
            pieCanvas.height = 150;
            chartsContainer.appendChild(pieCanvas);
            const pieCtx = pieCanvas.getContext('2d');
            new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: ['EQ', 'IQ', 'FQ', 'SQ'],
                    datasets: [{
                        data: [quizResults.eqPercent, quizResults.iqPercent, quizResults.fqPercent, quizResults.sqPercent],
                        backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b731'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    hover: {
                        mode: 'nearest',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 11
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Quotient Distribution',
                            font: {
                                size: 13
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            });

            // Bar Chart
            const barCanvas = document.createElement('canvas');
            barCanvas.width = 250;
            barCanvas.height = 150;
            chartsContainer.appendChild(barCanvas);
            const barCtx = barCanvas.getContext('2d');
            const ratings = [
                quizResults.eqPercent >= 80 ? 'Excellent' : quizResults.eqPercent >= 60 ? 'Good' : 'Needs Improvement',
                quizResults.iqPercent >= 80 ? 'Excellent' : quizResults.iqPercent >= 60 ? 'Good' : 'Needs Improvement',
                quizResults.fqPercent >= 80 ? 'Excellent' : quizResults.fqPercent >= 60 ? 'Good' : 'Needs Improvement',
                quizResults.sqPercent >= 80 ? 'Excellent' : quizResults.sqPercent >= 60 ? 'Good' : 'Needs Improvement'
            ];
            new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: ['EQ', 'IQ', 'FQ', 'SQ'],
                    datasets: [{
                        label: 'Percentage',
                        data: [quizResults.eqPercent, quizResults.iqPercent, quizResults.fqPercent, quizResults.sqPercent],
                        backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b731'],
                        borderWidth: 1,
                        borderRadius: 4,
                        hoverBackgroundColor: ['#ff5252', '#26a69a', '#2196f3', '#ffb300']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    hover: {
                        mode: 'index',
                        intersect: false,
                        animationDuration: 200
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Category Scores',
                            font: {
                                size: 13
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 11
                            },
                            bodyFont: {
                                size: 11
                            },
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.y.toFixed(1) + '% (' + ratings[context.dataIndex] + ')';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                font: {
                                    size: 11
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                font: {
                                    size: 11
                                },
                                stepSize: 20
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        startQuiz();
    </script>
</body>
</html>